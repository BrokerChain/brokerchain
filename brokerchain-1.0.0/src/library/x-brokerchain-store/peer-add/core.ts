// auto generated by dev/system

import { Logger } from "../../../myutils/logger.js";
import { Input, Output, Callback } from "./type.js";
import * as store from "../_/peer/index.js";

export async function core<R>(log: Logger, input: Input, cb: Callback<R>): Promise<R> {
    const now = new Date().toISOString();
    return await store.add(
        log,
        {
            id: "",
            ...store.make_private(),
            ...input.peer,
            create_time: now,
            update_time: now
        },
        {
            ok: (item) => {
                return cb.ok({ id: item.id });
            },
            fail: (err) => {
                return cb.fail(err);
            }
        }
    );
}
