// auto generated by dev/system

import { Record } from "immutable";
import { Content } from "./content.js";

export type Value = Record<Content>;

export class ValueIO {
    private _read: () => Value;
    private _write: (v: Value, silent: boolean) => void;

    constructor(_read: () => Value, _write: (v: Value, silent: boolean) => void) {
        this._read = _read;
        this._write = _write;
    }

    read(): Value {
        return this._read();
    }

    write(v: Value, silent = false) {
        this._write(v, silent);
        return this;
    }

    update(cb: (v: Value) => Value, silent = false) {
        this.write(cb(this.read()), silent);
        return this;
    }

    proxy(cb: SetValueProxy) {
        return new ValueIO(this._read, cb);
    }
}

type SetValueProxy = (v: Value) => Value;
