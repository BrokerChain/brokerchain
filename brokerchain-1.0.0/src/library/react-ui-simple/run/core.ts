// auto generated by dev/system

import { Logger } from "../../../myutils/logger.js";
import { Input, Output, Callback } from "./type.js";
import { build } from "../build/export.js";
import { _start } from "../_server/_start.js";

export async function core<R>(log: Logger, input: Input, cb: Callback<R>): Promise<R> {
    if (input.build) {
        await build(
            log,
            {},
            {
                ok: () => {
                    // ignore
                },
                fail: (err) => {
                    throw err;
                }
            }
        );
    }

    _start(log, {
        host: input.host,
        http_port: input.http_port,
        https_port: input.https_port
    });

    await new Promise((resolve) => {
        // never resolve
    });

    return cb.ok({});
}
